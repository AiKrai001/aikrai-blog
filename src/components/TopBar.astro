---
---

<header id="topbar" class="topbar">
  <div class="topbar-inner">
    <!-- 移动端菜单按钮 -->
    <button id="sidebar-toggle" class="sidebar-toggle" aria-label="Toggle sidebar">
      <i class="fas fa-bars"></i>
    </button>

    <!-- 面包屑导航 -->
    <nav class="breadcrumb" aria-label="breadcrumb">
      <ol class="breadcrumb-list" id="breadcrumb-list">
        <li class="breadcrumb-item">
          <a href="/">首页</a>
        </li>
      </ol>
    </nav>

    <!-- 右侧工具栏 -->
    <!-- <div class="topbar-tools"> -->
      <!-- 搜索栏 -->
      <!-- <div class="search-container">
        <div class="search-box">
          <i class="fas fa-search search-icon"></i>
          <input
            type="text"
            id="search-input"
            class="search-input"
            placeholder="搜索文章..."
            autocomplete="off"
          />
          <button id="search-clear" class="search-clear" aria-label="Clear search">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div id="search-results" class="search-results"></div>
      </div>
    </div> -->
  </div>
</header>

<style>
  .topbar {
    position: sticky;
    top: 0;
    height: var(--topbar-height);
    background-color: var(--topbar-bg);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border-color);
    z-index: 100;
  }

  .topbar-inner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 100%;
    padding: 0 2rem;
  }

  .sidebar-toggle {
    display: none;
    background: none;
    border: none;
    color: var(--text-color);
    font-size: 1.2rem;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 0.25rem;
    transition: background-color 0.3s ease;
  }

  .sidebar-toggle:hover {
    background-color: var(--hover-bg);
  }

  .breadcrumb {
    flex: 1;
  }

  .breadcrumb-list {
    display: flex;
    align-items: center;
    list-style: none;
    margin: 0;
    padding: 0;
    font-size: 0.9rem;
    gap: 0.375rem;
  }

  .breadcrumb-item {
    display: flex;
    align-items: center;
  }

  .breadcrumb-item:not(:last-child)::after { content: none; }
  .breadcrumb-sep { color: var(--text-muted); padding: 0 0.375rem; user-select: none; }

  .breadcrumb-item a {
    color: var(--text-muted) !important;
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .breadcrumb-item a:hover {
    color: var(--primary-color);
  }

  /* 非最后一项统一为次要色、常规字重 */
  .breadcrumb-item:not(:last-child) a,
  .breadcrumb-item:not(:last-child) span {
    color: var(--text-muted) !important;
    font-weight: var(--font-weight-normal, 400);
  }
  /* 最后一项（当前页）加深 */
  .breadcrumb-item:last-child span,
  .breadcrumb-item:last-child a { color: var(--text-color); font-weight: var(--font-weight-medium); }
  .breadcrumb-item:last-child a { pointer-events: none; }

  /* Global-scoped fixes so dynamically added items also style correctly */
  :global(#topbar .breadcrumb-item) {
    display: flex;
    align-items: center;
  }
  :global(#topbar .breadcrumb-sep) {
    color: var(--text-muted);
    padding: 0 0.375rem;
    user-select: none;
  }
  :global(#topbar .breadcrumb-item a),
  :global(#topbar .breadcrumb-item a:link),
  :global(#topbar .breadcrumb-item a:visited),
  :global(#topbar .breadcrumb-item a:active),
  :global(#topbar .breadcrumb-item a:focus) {
    color: var(--text-muted) !important;
    text-decoration: none;
    transition: color 0.3s ease;
  }
  :global(#topbar .breadcrumb-item a:hover) {
    color: var(--primary-color);
  }
  :global(#topbar .breadcrumb-item:not(:last-child) a),
  :global(#topbar .breadcrumb-item:not(:last-child) span) {
    color: var(--text-muted) !important;
    font-weight: var(--font-weight-normal, 400);
  }
  :global(#topbar .breadcrumb-item:last-child span),
  :global(#topbar .breadcrumb-item:last-child a) {
    color: var(--text-color);
    font-weight: var(--font-weight-medium);
  }
  :global(#topbar .breadcrumb-item:last-child a) {
    pointer-events: none;
  }

  .topbar-tools {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .search-container {
    position: relative;
  }

  .search-box {
    position: relative;
    display: flex;
    align-items: center;
    width: 300px;
    height: 2.5rem;
    background-color: var(--input-bg);
    border: 1px solid var(--input-border);
    border-radius: var(--border-radius-lg);
    transition: all var(--transition-fast);
  }

  .search-box:focus-within {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.1);
  }

  .search-icon {
    position: absolute;
    left: 0.75rem;
    color: var(--text-muted);
    font-size: 0.9rem;
    pointer-events: none;
  }

  .search-input {
    flex: 1;
    height: 100%;
    padding: 0 2.5rem 0 2.5rem;
    background: transparent;
    border: none;
    outline: none;
    color: var(--text-color);
    font-size: var(--font-size-sm);
  }

  .search-input::placeholder {
    color: var(--text-muted);
  }

  .search-clear {
    position: absolute;
    right: 0.5rem;
    display: none;
    align-items: center;
    justify-content: center;
    width: 1.5rem;
    height: 1.5rem;
    background: none;
    border: none;
    color: var(--text-muted);
    font-size: 0.8rem;
    cursor: pointer;
    border-radius: 50%;
    transition: all var(--transition-fast);
  }

  .search-clear:hover {
    color: var(--text-color);
    background-color: var(--hover-bg);
  }

  .search-clear.show {
    display: flex;
  }

  .search-results {
    position: absolute;
    top: calc(100% + 0.5rem);
    left: 0;
    right: 0;
    max-height: 400px;
    background-color: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-lg);
    overflow-y: auto;
    z-index: 1000;
    display: none;
  }

  .search-results.show {
    display: block;
  }

  .search-loading,
  .search-no-results,
  .search-error {
    padding: 1rem;
    text-align: center;
    color: var(--text-muted);
    font-size: var(--font-size-sm);
  }

  //.search-error {
  //  color: var(--danger-color);
  //}

  .search-result-item {
    border-bottom: 1px solid var(--border-color);
  }

  .search-result-item:last-child {
    border-bottom: none;
  }

  .search-result-link {
    display: block;
    padding: 1rem;
    color: inherit;
    text-decoration: none;
    transition: background-color var(--transition-fast);
  }

  .search-result-link:hover {
    background-color: var(--hover-bg);
  }

  .search-result-title {
    font-weight: 600;
    font-size: var(--font-size-base);
    color: var(--text-color);
    margin-bottom: 0.25rem;
    line-height: 1.4;
  }

  .search-result-excerpt {
    font-size: var(--font-size-sm);
    color: var(--text-muted);
    line-height: 1.5;
    margin-bottom: 0.5rem;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .search-result-meta {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: var(--font-size-xs);
    color: var(--text-muted);
  }

  .search-result-date {
    display: flex;
    align-items: center;
  }

  .search-result-date::before {
    content: '📅';
    margin-right: 0.25rem;
  }

  .search-result-category {
    display: flex;
    align-items: center;
    padding: 0.125rem 0.5rem;
    background-color: var(--tag-bg);
    color: var(--tag-color);
    border-radius: var(--border-radius);
    font-size: var(--font-size-xs);
  }

  .search-result-category::before {
    content: '🏷️';
    margin-right: 0.25rem;
  }

  /* 搜索高亮样式 */
  .search-results mark {
    background-color: var(--primary-color);
    color: white;
    padding: 0.125rem 0.25rem;
    border-radius: 0.125rem;
    font-weight: 600;
  }

  /* 响应式设计 */
  @media (max-width: 1199px) {
    .sidebar-toggle {
      display: block;
    }
  }

  @media (max-width: 768px) {
    .topbar-inner {
      padding: 0 1rem;
    }

    .breadcrumb {
      display: none;
    }
  }
</style>

<script>
  // Minimal script: sidebar toggle, theme icon, and breadcrumbs
  document.addEventListener('DOMContentLoaded', () => {
    const sidebarToggle = document.getElementById('sidebar-toggle');
    const sidebar = document.getElementById('sidebar');
    const sidebarOverlay = document.getElementById('sidebar-overlay');
    const themeToggle = document.getElementById('theme-toggle');
    const themeIcon = document.getElementById('theme-icon');

    function toggleSidebar() {
      sidebar?.classList.toggle('show');
      sidebarOverlay?.classList.toggle('show');
    }
    sidebarToggle?.addEventListener('click', toggleSidebar);
    sidebarOverlay?.addEventListener('click', toggleSidebar);

    function updateThemeIcon(isDark: boolean) {
      if (themeIcon) themeIcon.setAttribute('data-theme', isDark ? 'dark' : 'light');
    }
    const currentTheme = localStorage.getItem('theme') || 'light';
    updateThemeIcon(currentTheme === 'dark');
    themeToggle?.addEventListener('click', () => {
      const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
      const newTheme = isDark ? 'light' : 'dark';
      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
      updateThemeIcon(newTheme === 'dark');
    });

    // Breadcrumbs
    const breadcrumbList = document.getElementById('breadcrumb-list');
    if (breadcrumbList) {
      const pathSegments = window.location.pathname.split('/').filter(Boolean);
      const homeItem = breadcrumbList.querySelector('.breadcrumb-item');
      breadcrumbList.innerHTML = '';
      if (homeItem) breadcrumbList.appendChild(homeItem);

      let currentUrl = '';
      pathSegments.forEach((segment, index) => {
        currentUrl += '/' + segment;
        const isLast = index === pathSegments.length - 1;

        const li = document.createElement('li');
        li.className = 'breadcrumb-item';
        let displayName = segment;
        try { displayName = decodeURIComponent(segment.split('~').join('%')); } catch {}
        // Skip the pseudo folder "blog" (no index page)
        if (segment === 'blog' && pathSegments.length > 1) {
          return;
        }
        if (segment === 'categories') displayName = '分类';
        else if (segment === 'tags') displayName = '标签';
        else if (segment === 'archives') displayName = '归档';
        else if (segment === 'about') displayName = '关于';
        else if (pathSegments[0] === 'blog' && isLast) {
          // Prettify last blog slug
          if (displayName.includes('-')) {
            displayName = displayName.replace(/-/g, ' ').replace(/\b\w/g, s => s.toUpperCase());
          }
        }

        const sep = document.createElement('li');
        sep.className = 'breadcrumb-sep';
        sep.textContent = '/';
        breadcrumbList.appendChild(sep);

        li.innerHTML = isLast ? `<span>${displayName}</span>` : `<a href="${currentUrl}">${displayName}</a>`;
        breadcrumbList.appendChild(li);
      });
    }
  });
</script>



